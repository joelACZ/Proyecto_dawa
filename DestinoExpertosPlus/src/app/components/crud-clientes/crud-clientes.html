<app-card
  title="Gestión de Clientes"
  subtitle="Administra los clientes ofrecidos en la plataforma"
  content="Aquí puedes crear, editar y eliminar clientes, así como gestionar sus detalles">
</app-card>

<div>
  <input #busc type="text" placeholder="Buscar cliente..." (input)="search(busc)">
  <button (click)="openNew()">
    <i class="bi bi-person-plus"></i> agregar
  </button>
</div>

<app-data-table [data]="clientes" [columns]="columns">
  <ng-template #actions let-row>
    <div>
      <button (click)="openView(row)">
        <i class="bi bi-eye"></i>
      </button>
      <button (click)="openEdit(row)">
        <i class="bi bi-pencil"></i>
      </button>
      <button (click)="delete(row)">
        <i class="bi bi-trash"></i>
      </button>
    </div>
  </ng-template>
</app-data-table>

<app-detail-modal [isVisible]="showViewModal" [data]="clienteView" (close)="closeViewModal()"></app-detail-modal>

<div *ngIf="showEditModal" (click)="closeEditModal()">
  <div (click)="$event.stopPropagation()">
    <div>
      <h3>
        <i class="bi" [class.bi-pencil]="editingId" [class.bi-person-plus]="!editingId"></i>
        {{ editingId ? 'Editar' : 'Nuevo' }} Cliente
      </h3>
      <button (click)="closeEditModal()">
        <i class="bi bi-x-lg"></i>
      </button>
    </div>

    <form [formGroup]="formCliente" (ngSubmit)="save()">
      <div>
        <div>
          <label><i class="bi bi-person"></i> Nombre *</label>
          <input formControlName="nombre">
        </div>
        <div>
          <label><i class="bi bi-envelope"></i> Email *</label>
          <input formControlName="email">
        </div>
        <div>
          <label><i class="bi bi-telephone"></i> Teléfono *</label>
          <input formControlName="telefono">
        </div>
        <div>
          <label><i class="bi bi-geo-alt"></i> Dirección</label>
          <input formControlName="direccion">
        </div>
        <div>
          <label><i class="bi bi-tags"></i> Preferencias (separadas por coma)</label>
          <input formControlName="preferencias" placeholder="Ej: Electricidad, Urgente">
        </div>
        <div>
          <input type="checkbox" formControlName="notificaciones">
          <label><i class="bi bi-bell"></i> Recibir notificaciones</label>
        </div>
      </div>

      <div>
        <button type="button" (click)="closeEditModal()">
          <i class="bi bi-x-circle"></i> Cancelar
        </button>
        <button type="submit">
          <i class="bi" [class.bi-check-circle]="!editingId" [class.bi-arrow-clockwise]="editingId"></i>
          {{ editingId ? 'Actualizar' : 'Crear' }}
        </button>
      </div>
    </form>
  </div>
</div>